<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title> Flappy Bird</title>
  <style>
    body {
      margin: 0;
      background: #70c5ce;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      overflow: hidden;
      font-family: Arial, sans-serif;
    }
    canvas {
      background: #70c5ce;
      border: 2px solid #333;
      border-radius: 10px;
    }
    #homeBtn {
      position: absolute;
      top: 15px;
      left: 15px;
      padding: 10px 20px;
      font-size: 16px;
      font-weight: bold;
      background: #ffcc00;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      z-index: 2;
    }
    #homeBtn:hover {
      background: #ff9900;
    }
  </style>
</head>
<body>
    <div id="homeBtn">
  <button onclick="location.href='index.html'">üè† Home</button>
    </div>
  <canvas id="gameCanvas"></canvas>

<script>
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");

canvas.width = window.innerWidth < 500 ? window.innerWidth - 20 : 400;
canvas.height = window.innerHeight < 700 ? window.innerHeight - 40 : 600;

// --- Game variables ---
let bird, pipes, frame, score, gameOver;

// --- Sounds ---
const flapSound = new Audio("https://actions.google.com/sounds/v1/cartoon/wood_plank_flicks.ogg");
const scoreSound = new Audio("https://actions.google.com/sounds/v1/cartoon/clang_and_wobble.ogg");
const hitSound = new Audio("https://actions.google.com/sounds/v1/cartoon/metal_clank_and_wobble.ogg");

// --- Reset Game ---
function resetGame() {
  bird = { x: 80, y: canvas.height/2, w: 30, h: 30, gravity: 0.18, lift: -5, velocity: 0 };
  pipes = [];
  frame = 0;
  score = 0;
  gameOver = false;
}

// --- Draw Bird ---
function drawBird() {
  ctx.fillStyle = "yellow";
  ctx.beginPath();
  ctx.arc(bird.x, bird.y, bird.w/2, 0, Math.PI*2);
  ctx.fill();
}

// --- Draw Pipes ---
function drawPipes() {
  ctx.fillStyle = "green";
  for (let pipe of pipes) {
    ctx.fillRect(pipe.x, 0, pipe.w, pipe.top);
    ctx.fillRect(pipe.x, pipe.top + pipe.gap, pipe.w, canvas.height - pipe.top - pipe.gap);
  }
}

// --- Update ---
function update() {
  if (gameOver) return;

  bird.velocity += bird.gravity;
  bird.y += bird.velocity;

  // Prevent bird from falling through floor
  if (bird.y + bird.h/2 >= canvas.height) {
    gameOver = true;
    hitSound.play();
  }

  // Add pipes slower (frame % 150 instead of 90)
  if (frame % 150 === 0) {
    let top = Math.floor(Math.random() * (canvas.height - 200)) + 50;
    pipes.push({ x: canvas.width, w: 50, top: top, gap: 150, passed: false });
  }

  // Move pipes slower (1.2 instead of 2)
  for (let pipe of pipes) {
    pipe.x -= 1.2;

    // Collision check
    if (bird.x + bird.w/2 > pipe.x && bird.x - bird.w/2 < pipe.x + pipe.w) {
      if (bird.y - bird.h/2 < pipe.top || bird.y + bird.h/2 > pipe.top + pipe.gap) {
        gameOver = true;
        hitSound.play();
      }
    }

    // Scoring
    if (!pipe.passed && pipe.x + pipe.w < bird.x - bird.w/2) {
      score++;
      pipe.passed = true;
      scoreSound.play();
    }
  }

  // Remove off-screen pipes
  pipes = pipes.filter(pipe => pipe.x + pipe.w > 0);

  frame++;
}

// --- Draw Game ---
function draw() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);

  drawBird();
  drawPipes();

  ctx.fillStyle = "white";
  ctx.font = "24px Arial";
  ctx.fillText("Score: " + score, 10, 30);

  if (gameOver) {
    ctx.fillStyle = "red";
    ctx.font = "40px Arial";
    ctx.fillText("Game Over", canvas.width/2 - 100, canvas.height/2);

    ctx.fillStyle = "white";
    ctx.font = "20px Arial";
    ctx.fillText("Tap to Restart", canvas.width/2 - 70, canvas.height/2 + 40);
  }
}

// --- Game Loop ---
function gameLoop() {
  update();
  draw();
  requestAnimationFrame(gameLoop);
}

// --- Controls ---
function flap() {
  if (!gameOver) {
    bird.velocity = bird.lift;
    flapSound.play();
  } else {
    // Tap to restart
    resetGame();
  }
}
document.addEventListener("keydown", e => {
  if (e.code === "Space" || e.code === "ArrowUp") flap();
});
canvas.addEventListener("click", flap);
canvas.addEventListener("touchstart", flap);

// --- Home Button ---
document.getElementById("homeBtn").addEventListener("click", () => {
  resetGame();
});

// Start
resetGame();
gameLoop();
</script>
</body>
</html>
